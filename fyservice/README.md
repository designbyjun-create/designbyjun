# 包車行程報價產生器 開發手冊

## 📋 專案概述

這是一個為「旅乘-日本自由行包車」服務設計的內部工具，用於快速產生標準化的包車報價格式，提升客服工作效率。

### 核心目標
- 透過點選/填選方式快速產出標準報價格式
- 避免人工遺漏與格式錯誤
- 支援桌機、平板、手機使用（RWD）
- 即時預覽與一鍵複製功能

---

## 🎯 功能規格

### 輸出內容
報價格式僅包含以下項目，不顯示價格或說明文字：
- 日期
- 人數
- 行李
- 汽座（符合條件才顯示）
- 車款
- 行程（依規則自動判斷類型）

### 輸出範例
```
日期：2025/01/15-01/17
人數：5大1小(3歲)
行李：5件
汽座：1個安全座椅
車款：7人座舒適款/10人座海獅
行程：
01/15 成田機場至東京市區-單程(10座)
01/16 東京往返富士山>河口湖一日遊(10小時)(7座/10座)
01/17 東京至成田機場-單程(10座)
```

---

## 🏗️ 專案結構

```
charter-quote-generator/
├── index.html              # 主頁面
├── styles/
│   ├── _variables.scss     # 變數定義（顏色、間距）
│   ├── _mixins.scss        # Mixins（RWD斷點）
│   ├── _reset.scss         # CSS Reset
│   ├── _base.scss          # 基礎樣式
│   ├── _layout.scss        # 佈局樣式
│   ├── _components.scss    # 元件樣式
│   └── main.scss           # 主樣式入口
├── scripts/
│   ├── config.js           # 設定檔
│   ├── calculator.js       # 計算邏輯
│   ├── formatter.js        # 格式產生器
│   └── main.js             # 主程式
├── README.md               # 本文件
└── CHANGELOG.md            # 版本記錄
```

---

## 🎨 介面設計

### 桌機版（≥1024px）
- 左右分欄佈局
- 左側：編輯區（40%）
- 右側：即時預覽（60%）

### 平板版（768px - 1023px）
- 左右分欄佈局
- 左側：編輯區（50%）
- 右側：預覽區（50%）

### 手機版（< 768px）
- 上下堆疊佈局
- 編輯區可滾動
- 預覽區固定底部（可展開/收合）

---

## 🧩 核心功能模組

### 1. 基本資訊模組
**功能：**
- 日期選擇（單日/多日/彈性/不確定）
- 人數設定（大人/小孩+年齡）
- 行李設定（行李/推車/登機箱）
- 汽座自動計算

**規則：**
- 0-1歲：嬰兒座椅
- 1-3歲：安全座椅
- 4-6歲：增高墊
- 7歲以上：不顯示
- 最多顯示2個汽座

---

### 2. 車款選擇模組
**功能：**
- 多選車款（7座/10座/14座/19座）
- 智慧建議（根據人數+行李+行程類型）
- 每日車款獨立選擇

**判斷邏輯：**
| 行程類型 | 考慮人數 | 考慮行李 | 說明 |
|---------|---------|---------|------|
| 機場接送/單程 | ✓ | ✓ | 人數+行李都計算 |
| 往返一日遊 | ✓ | ✗ | 只算人數（無大行李） |
| 接送來回 | ✓ | ✗ | 只算人數 |

**車款容量：**
| 車款 | 最大人數 | 最大行李 |
|------|---------|---------|
| 7人座舒適款 | 6人 | 4件 |
| 10人座海獅 | 9人 | 7件 |
| 14人座海獅 | 13人 | 10件 |
| 19座考斯特 | 18人 | 15件 |

---

### 3. 行程編輯模組
**功能：**
- 多日行程管理（新增/刪除/排序）
- 行程類型切換（單程/往返一日遊/接送來回）
- 時間設定（選填）
- 起點/終點選擇（下拉+自訂）
- 景點串接（往返一日遊專用）
- 住宿處理（司機留當地 vs 返回車庫）
- 時數手動調整

**行程類型：**

#### A. 單程
- 格式：`起點至終點-單程`
- 時數：不標註（純運輸）
- 範例：`成田機場至東京市區-單程`

#### B. 往返一日遊
- 格式：`起點往返景點>景點>景點一日遊(10小時)`
- 時數：標註（通常10h）
- 範例：`東京往返富士山>河口湖一日遊(10小時)`

#### C. 接送來回（樂園）
- 格式：`起點樂園名稱接送來回`
- 時數：不標註
- 範例：`東京迪士尼樂園接送來回`

#### D. 一日遊（有終點，不回起點）
- 格式：`起點至景點>景點一日遊，宿終點(Xh)`
- 時數：標註（需手動調整）
- 範例：`河口湖至富士山一日遊，宿東京市區(10小時)`

---

### 4. 住宿費處理邏輯

**標註規則：**
- `*宿XXX`：支付司機住宿費
- `宿XXX`：不支付司機住宿費（僅說明住宿地）

**時數影響：**
```
Day 1: 東京市區至河口湖*宿河口湖(10小時)
       ↑ 有 *宿，司機在河口湖待命

Day 2: *宿河口湖往返富士山一日遊(10小時)
       ↑ 接續住宿，10小時（司機已在當地）

Day 3: 河口湖至東京市區-單程
       ↑ 前日無 *宿河口湖（Day2結尾），需扣除空車時間
```

**介面設計：**
```
☑ 當晚司機留在當地（支付住宿費）
   過夜地點：[河口湖]（自動帶入終點）
   💡 標註 *宿河口湖
   💡 時數建議調整為 10 小時
```

---

### 5. 時數計算邏輯

**基礎規則：**
- 市區出發 → 10小時
- 異地出發（無前日*宿）→ 8小時
- 異地出發（有前日*宿）→ 10小時
- 勾選「司機留在當地」→ 建議10小時

**市區定義：**
東京市區、大阪市區、名古屋市區、福岡市區、京都市區

**特殊情況：**
- 時數僅為「建議值」，客服可手動調整
- 不同異地扣除時數不同（河口湖2h、長野3h、白川鄉4h）
- 未來透過 Google Sheets 管理扣除規則

---

## 🎯 多方案處理

### 車款方案
當選擇多種車款時，每天行程可選擇：
- 單一車款：`(7座)` 或 `(10座)`
- 多種車款：`(7座/10座)`
- 多台車款：`(10+7座)`

### 行程方案（ABC）
用於「不確定日期」或「提供客人選擇」：
```
01/16 A 東京往返富士山一日遊(10小時)
01/16 B 東京往返箱根一日遊(10小時)
01/16 C 東京迪士尼樂園接送來回
```

---

## 🔧 技術實作細節

### HTML 結構原則
- 語意化標籤（`<section>`, `<aside>`, `<header>`）
- 表單元件使用原生 HTML5
- 可訪問性（ARIA labels）

### SCSS 架構
```scss
// _variables.scss
$primary-blue: #2563eb;
$light-blue: #dbeafe;
$dark-blue: #1e40af;
$success: #10b981;
$warning: #f59e0b;
$gray: #6b7280;

// RWD 斷點
$breakpoint-mobile: 768px;
$breakpoint-tablet: 1024px;
```

### JavaScript 模組化
- ES6 語法
- 事件委派（Event Delegation）
- 即時更新（Input event listeners）
- 狀態管理（單一資料來源）

---

## 🚀 開發階段規劃

### Phase 1 - 基礎功能（已完成）
- [x] HTML 結構
- [x] SCSS 樣式與 RWD
- [x] 基本表單輸入
- [x] 即時預覽
- [x] 格式產生
- [x] 複製功能

### Phase 2 - 進階邏輯（待開發）
- [ ] 時數自動計算
- [ ] 車款智慧建議
- [ ] 汽座自動判斷
- [ ] 表單驗證與提示
- [ ] 本地儲存草稿

### Phase 3 - Google Sheets 串接（待開發）
- [ ] Sheets API 整合
- [ ] 快速路線讀取
- [ ] 常用地點下拉選單
- [ ] 時數扣除規則查表
- [ ] 車款容量規則

---

## 📊 Google Sheets 資料結構（Phase 3）

### Sheet 1: 快速路線庫
| 欄位 | 說明 | 範例 |
|------|------|------|
| 路線ID | 唯一識別碼 | TYO001 |
| 起點區域 | 出發城市 | 東京市區 |
| 路線名稱 | 顯示名稱 | 經典富士山路線 |
| 景點串接 | 用>連接 | 河口湖>忍野八海>御殿場 |
| 預設時數 | 建議時數 | 10 |
| 適用車款 | 逗號分隔 | 7座,10座 |
| 狀態 | 啟用/停用 | 啟用 |

### Sheet 2: 常用地點庫
| 欄位 | 說明 | 範例 |
|------|------|------|
| 地點ID | 唯一識別碼 | TYO_CTR |
| 地點名稱 | 顯示名稱 | 東京市區 |
| 所屬區域 | 地區分類 | 東京 |
| 類型 | 市區/機場/景點/樂園 | 市區 |
| 是否市區 | 用於時數計算 | 是 |
| 排序 | 顯示順序 | 1 |

### Sheet 3: 車款容量規則
| 車款名稱 | 最大人數 | 最大行李 | 備註 |
|---------|---------|---------|------|
| 7人座舒適款 | 6 | 4 | 含司機共7座 |
| 10人座海獅 | 9 | 7 | 含司機共10座 |
| 14人座海獅 | 13 | 10 | 含司機共14座 |
| 19座考斯特 | 18 | 15 | 含司機共19座 |

### Sheet 4: 時數扣除規則
| 地點名稱 | 所屬區域 | 距離車庫(km) | 空車時數扣除 | 備註 |
|---------|---------|-------------|-------------|------|
| 東京市區 | 東京 | 0 | 0 | 車庫所在地 |
| 成田機場 | 東京 | 60 | 2 | |
| 河口湖 | 山梨 | 100 | 2 | |
| 長野 | 長野 | 220 | 3 | 較遠異地 |
| 白川鄉 | 岐阜 | 400 | 4 | 極遠異地 |

---

## 🎯 使用流程

### 客服操作步驟
1. 開啟網頁（書籤/GitHub Pages）
2. 填寫基本資訊（日期、人數、行李）
3. 系統自動計算汽座
4. 選擇車款（或使用系統建議）
5. 編輯每日行程
   - 選擇行程類型
   - 填寫起點/終點/景點
   - 調整時數（如需要）
   - 設定住宿（如需要）
   - 選擇當日車款
6. 查看即時預覽
7. 一鍵複製格式
8. 貼到 LINE/FB/IG 給客人

### 複製後使用情境
- 貼到 LINE 直接傳客人
- 貼到 Facebook/Instagram 訊息
- 貼到內部 Google Sheets（未來可自動化）

---

## ⚠️ 重要規則與限制

### 禁止事項
❌ 不顯示價格
❌ 不自動補充行程內容
❌ 不加入說明文字或問句
❌ 不修改使用者已確認的欄位

### 格式規範
✅ 行程上方不空行
✅ 不使用條列符號（•、-）
✅ 第一段必用「至」連接
✅ 景點一律用「>」連接
✅ 多日行程每行加上 MM/DD
✅ 單日行程不加日期

### 範例對照

**❌ 錯誤格式：**
```
行程：
• 08:00 從成田機場出發
• 前往東京市區飯店
```

**✅ 正確格式：**
```
行程：
08:00 成田機場至東京市區-單程
```

---

## 🔄 版本更新記錄

### v1.0.0 (2025/01/XX)
- ✅ 初版發布
- ✅ 基礎功能完成
- ✅ RWD 響應式佈局
- ✅ 即時預覽與複製

### v1.1.0 (規劃中)
- [ ] Google Sheets API 串接
- [ ] 快速路線功能
- [ ] 智慧時數計算
- [ ] 本地儲存草稿

---

## 📞 聯絡資訊

**專案負責人：** Jun
**公司：** Forever young株式会社
**服務：** 旅乘-日本自由行包車

---

## 📝 授權說明

本專案為內部使用工具，不對外公開授權。

---

**最後更新：** 2025/12/20
**文件版本：** 1.0.0
